FROM node:22.8-bookworm
ENV DEBIAN_FRONTEND=noninteractive
RUN apt-get update && \
    apt-get install -y \
    build-essential \
    curl \
    libcurl4-openssl-dev \
    libwebkit2gtk-4.0-dev \
    libgtk-3-dev \
    pkg-config \
    git \
    x11-apps \
    vim \
    && apt-get clean
RUN apt-get install -y redis-server
WORKDIR /src
COPY ./src .
RUN apt-get install -y redis-server
RUN apt-get install -y xvfb
RUN apt-get install -y dnsutils
ENV DISPLAY=:99
RUN chmod -R 555 /src
RUN useradd -ms /bin/bash admin
RUN mkdir -p /data && \
    chown redis:redis /data
RUN sed -i 's#^dir .*#dir /data#' /etc/redis/redis.conf
USER admin
CMD [ "sh", "start.sh" ]


