const express = require('express');

const checkHeader = (req, res, next) => {
    header = req.header('x-auth-key')
    if (header === "flag{uS3rs-k3y-r3v3rs3d-lol}" || header === "flag{uS3Rs-k3y-R3v3Rs3d-lol}") {
        req.privilege = 'user'
        next()
    }
    else if (header === "dhfkshf784hkhwkfhd8whkhkjfs") {
        req.privilege = 'admin'
        next()
    }
    else {
        return res.status(400).json({ error: 'bad x-auth-key' });

    }


}

module.exports = checkHeader