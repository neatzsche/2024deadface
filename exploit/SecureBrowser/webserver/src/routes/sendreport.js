const express = require('express')
const shellescape = require('shell-escape')
const router = express.Router()

router.post('/', async function (req, res, next) {
    if (req.privilege != "admin" && req.privilege != "user") {
        return res.status(400).json({ error: "must be user or admin" })
    } else {
        try {
            var { exec } = require('child_process');
            exec(shellescape(['/src/bin/dead_browse', `--url=http://localhost:3000/${req.body.data}`, , '--auth-key=dhfkshf784hkhwkfhd8whkhkjfs']),
                {
                    shell: '/bin/bash'
                });

            return res.status(200).json({ message: "success" })
        } catch {
            return res.status(200).json({ message: "success" })
        }
    }
}
)

module.exports = router